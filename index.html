
<!DOCTYPE html>
<html>
  <!--  search health inspections by zipcode -->
  <title>Chicago Inspection</title>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Info Windows</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <h1> Enter in a Chicago Zip Code to search for health inspections<br> </h1>
    <form>
      <input id="zip" type="text" placeholder="Enter a search value">

      <button disabled type="button">Click me</button>


    </form>  


    <div id="map"></div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  



    <script>

      // This example displays a marker at the center of Australia.
      // When the user clicks the marker, an info window opens.

      function initMap() {
        var chicago = {lat: 41.8781, lng: -87.6298};
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 11,
          center: chicago
        });

        var endpoint = "https://data.cityofchicago.org/resource/cwig-ma7x.json";


        var url = endpoint + "?zip=" + $("#zip").val();

        $.ajax({
              url: url,
              type: "GET",
              data: {
                "$limit" : 50
              }
          }).done(function(data) {
            //alert("Retrieved " + data.length + " records from the dataset!");
            console.log(data);


            $.each(data, function(i,v) {
                  
                  
                  var marker = new google.maps.Marker({
                            position: {lat: parseFloat(v.latitude), lng: parseFloat(v.longitude)},
                            map: map,
                            title: 'Chicago'
                          });
              
                  var infowindow = new google.maps.InfoWindow({
                    content: "<h1>" + v.dba_name + "</h1>"
                  });

                  marker.addListener('click', function() {
                    infowindow.open(map, marker);
                  });


            });

          });




        

        

      }
    </script>


  <script>
  
      $("button").on("click", initMap)

      $("#zip").on("input", function(e) {
        if ($("#zip").val() != "") {
          $("button").prop("disabled", false);
        } else {
          $("button").prop("disabled", true);
        }
      });



  </script>


    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDo_yca_aaN-QKTQQ5kAgdGuj0mwbP-uvw">
    </script>
  </body>
</html>
